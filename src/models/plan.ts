/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import { remap as remap$ } from "../lib/primitives.js";
import { safeParse } from "../lib/schemas.js";
import { ClosedEnum } from "../types/enums.js";
import { Result as SafeParseResult } from "../types/fp.js";
import { SDKValidationError } from "./errors/sdkvalidationerror.js";
import { Price, Price$inboundSchema } from "./price.js";

export const PlanObject = {
  Plan: "plan",
} as const;
export type PlanObject = ClosedEnum<typeof PlanObject>;

export type PlanPaymentTerm = {
  inArrears?: boolean | undefined;
  instant?: boolean | undefined;
};

/**
 * Whether tax is added on top of the price (exclusive) or included in the price (inclusive)
 */
export const TaxBehavior = {
  Exclusive: "exclusive",
  Inclusive: "inclusive",
} as const;
/**
 * Whether tax is added on top of the price (exclusive) or included in the price (inclusive)
 */
export type TaxBehavior = ClosedEnum<typeof TaxBehavior>;

export type Plan = {
  /**
   * Unique identifier for a plan
   */
  id: string;
  object: PlanObject;
  billingInterval: string;
  createdAt: Date;
  currency: string;
  /**
   * Default tax code for plan line items. Common values: 'eservice' (electronically supplied services), 'saas' (software as a service), 'consulting', 'ebook', 'standard', 'reduced', 'exempt'. Full list available via GET /tax/codes endpoint.
   */
  defaultTaxCode?: string | undefined;
  /**
   * Fallback tax rate (as percentage) if automatic tax calculation is unavailable
   */
  defaultTaxRate?: number | undefined;
  deletedAt?: Date | undefined;
  description?: string | undefined;
  invoiceDisplayName?: string | undefined;
  /**
   * Unique identifier for an organization
   */
  merchantId: string;
  name: string;
  paymentTerm?: PlanPaymentTerm | undefined;
  prices?: Array<Price> | undefined;
  /**
   * Unique identifier for a product
   */
  productId: string;
  /**
   * Whether tax is added on top of the price (exclusive) or included in the price (inclusive)
   */
  taxBehavior?: TaxBehavior | undefined;
  updatedAt: Date;
  /**
   * Unique identifier for a wallet namespace
   */
  walletNamespaceId?: string | undefined;
  /**
   * Whether renewal reminder emails are enabled for subscriptions using this plan
   */
  renewalReminderEnabled?: boolean | undefined;
  /**
   * Number of days before renewal to send the reminder email
   */
  renewalReminderDays?: number | undefined;
};

/** @internal */
export const PlanObject$inboundSchema: z.ZodNativeEnum<typeof PlanObject> = z
  .nativeEnum(PlanObject);

/** @internal */
export const PlanPaymentTerm$inboundSchema: z.ZodType<
  PlanPaymentTerm,
  z.ZodTypeDef,
  unknown
> = z.object({
  in_arrears: z.boolean().optional(),
  instant: z.boolean().optional(),
}).transform((v) => {
  return remap$(v, {
    "in_arrears": "inArrears",
  });
});

export function planPaymentTermFromJSON(
  jsonString: string,
): SafeParseResult<PlanPaymentTerm, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => PlanPaymentTerm$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'PlanPaymentTerm' from JSON`,
  );
}

/** @internal */
export const TaxBehavior$inboundSchema: z.ZodNativeEnum<typeof TaxBehavior> = z
  .nativeEnum(TaxBehavior);

/** @internal */
export const Plan$inboundSchema: z.ZodType<Plan, z.ZodTypeDef, unknown> = z
  .object({
    id: z.string(),
    object: PlanObject$inboundSchema,
    billingInterval: z.string(),
    createdAt: z.string().datetime({ offset: true }).transform(v =>
      new Date(v)
    ),
    currency: z.string(),
    defaultTaxCode: z.string().optional(),
    defaultTaxRate: z.number().optional(),
    deletedAt: z.string().datetime({ offset: true }).transform(v => new Date(v))
      .optional(),
    description: z.string().optional(),
    invoiceDisplayName: z.string().optional(),
    merchantId: z.string(),
    name: z.string(),
    paymentTerm: z.lazy(() => PlanPaymentTerm$inboundSchema).optional(),
    prices: z.array(Price$inboundSchema).optional(),
    productId: z.string(),
    taxBehavior: TaxBehavior$inboundSchema.optional(),
    updatedAt: z.string().datetime({ offset: true }).transform(v =>
      new Date(v)
    ),
    walletNamespaceId: z.string().optional(),
    renewalReminderEnabled: z.boolean().optional(),
    renewalReminderDays: z.number().int().optional(),
  });

export function planFromJSON(
  jsonString: string,
): SafeParseResult<Plan, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => Plan$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'Plan' from JSON`,
  );
}
