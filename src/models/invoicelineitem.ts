/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import { safeParse } from "../lib/schemas.js";
import { ClosedEnum } from "../types/enums.js";
import { Result as SafeParseResult } from "../types/fp.js";
import { SDKValidationError } from "./errors/sdkvalidationerror.js";

/**
 * Type of event: 'usage' for billable metric events, 'fee' for fee events
 */
export const EventType = {
  Usage: "usage",
  Fee: "fee",
} as const;
/**
 * Type of event: 'usage' for billable metric events, 'fee' for fee events
 */
export type EventType = ClosedEnum<typeof EventType>;

/**
 * Type of line item: 'charge' for regular billing, 'refund' for refunded items (amounts are negated)
 */
export const LineItemType = {
  Charge: "charge",
  Refund: "refund",
} as const;
/**
 * Type of line item: 'charge' for regular billing, 'refund' for refunded items (amounts are negated)
 */
export type LineItemType = ClosedEnum<typeof LineItemType>;

export type InvoiceLineItem = {
  /**
   * Type of event: 'usage' for billable metric events, 'fee' for fee events
   */
  eventType: EventType;
  /**
   * The event ID (usage_event_id or fee_event_id)
   */
  eventId: string;
  /**
   * Source ID: billable_metric_id for usage events, fee_id for fee events
   */
  eventSourceId: string;
  /**
   * HOTFIX: Mirrors eventSourceId for backward compatibility
   */
  billableMetricId: string;
  /**
   * Display name for this line item on invoices
   */
  invoiceDisplayName: string;
  /**
   * Type of line item: 'charge' for regular billing, 'refund' for refunded items (amounts are negated)
   */
  lineItemType: LineItemType;
  /**
   * The meter event ID (usage events only)
   */
  meterEventId: string;
  /**
   * Description of what this metric or fee measures
   */
  metricDescription: string;
  /**
   * Human-readable name of the billable metric or fee
   */
  metricName: string;
  /**
   * Measurement unit label. Sample values: 'calls' for API calls, 'GB' for storage, 'hours' for compute time, 'tokens' for LLM tokens, 'charge' for fees
   */
  metricUnit: string;
  /**
   * Quantity of usage. Negative for refunds.
   */
  quantity: number;
  /**
   * Tax rate as decimal (0.10 = 10%)
   */
  taxRate: number;
  /**
   * Total amount (totalPrice + totalTax) in decimal dollars. Negative for refunds.
   */
  totalAmount: string;
  /**
   * Total price (tax-exclusive) in decimal dollars. Negative for refunds.
   */
  totalPrice: string;
  /**
   * Total tax in decimal dollars. Negative for refunds.
   */
  totalTax: string;
  /**
   * Unit price in decimal dollars
   */
  unitPrice: string;
};

/** @internal */
export const EventType$inboundSchema: z.ZodNativeEnum<typeof EventType> = z
  .nativeEnum(EventType);

/** @internal */
export const LineItemType$inboundSchema: z.ZodNativeEnum<typeof LineItemType> =
  z.nativeEnum(LineItemType);

/** @internal */
export const InvoiceLineItem$inboundSchema: z.ZodType<
  InvoiceLineItem,
  z.ZodTypeDef,
  unknown
> = z.object({
  eventType: EventType$inboundSchema,
  eventId: z.string(),
  eventSourceId: z.string(),
  billableMetricId: z.string(),
  invoiceDisplayName: z.string(),
  lineItemType: LineItemType$inboundSchema,
  meterEventId: z.string(),
  metricDescription: z.string(),
  metricName: z.string(),
  metricUnit: z.string(),
  quantity: z.number(),
  taxRate: z.number(),
  totalAmount: z.string(),
  totalPrice: z.string(),
  totalTax: z.string(),
  unitPrice: z.string(),
});

export function invoiceLineItemFromJSON(
  jsonString: string,
): SafeParseResult<InvoiceLineItem, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => InvoiceLineItem$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'InvoiceLineItem' from JSON`,
  );
}
